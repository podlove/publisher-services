{
  "packages": ["nodejs@latest", "elixir@latest", "erlang@latest", "caddy@latest"],
  "env": {
    "DEVBOX_COREPACK_ENABLED": "true",
    "MIX_HOME": "$PWD/server/.nix-mix",
    "HEX_HOME": "$PWD/server/.nix-hex",
    "ERL_AFLAGS": "-kernel shell_history enabled'"
  },
  "shell": {
    "scripts": {
      "bootstrap:client": ["cd client", "pnpm install"],
      "bootstrap:server": [
        "cd server",
        "mkdir -p .nix-mix",
        "mkdir -p .nix-hex",
        "mix local.hex --force",
        "mix local.rebar --force",
        "mix deps.get"
      ],
      "bootstrap": ["devbox run bootstrap:client", "devbox run bootstrap:server"],
      "test": ["devbox run test:server"],
      "test:server": ["cd server", "mix test"],
      "server": ["cd server", "mix phx.server"],
      "client": ["cd client", "pnpm run dev"],
      "build:client": ["cd client", "pnpm build"],
      "build": ["devbox run build:client"]
    }
  }
}
